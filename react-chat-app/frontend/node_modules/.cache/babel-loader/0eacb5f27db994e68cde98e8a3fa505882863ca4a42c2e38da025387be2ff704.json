{"ast":null,"code":"const crypto = require(\"crypto\");\nconst util = require(\"./util\");\n\n/** Verifies and signs data against the key and secret.\n *\n * @constructor\n * @param {String} key app key\n * @param {String} secret app secret\n */\nclass Token {\n  constructor(key, secret) {\n    this.key = key;\n    this.secret = secret;\n  }\n  /** Signs the string using the secret.\n   *\n   * @param {String} string\n   * @returns {String}\n   */\n  sign(string) {\n    return crypto.createHmac(\"sha256\", this.secret).update(Buffer.from(string)).digest(\"hex\");\n  }\n  /** Checks if the string has correct signature.\n   *\n   * @param {String} string\n   * @param {String} signature\n   * @returns {Boolean}\n   */\n  verify(string, signature) {\n    return util.secureCompare(this.sign(string), signature);\n  }\n}\nmodule.exports = Token;","map":{"version":3,"names":["crypto","require","util","Token","constructor","key","secret","sign","string","createHmac","update","Buffer","from","digest","verify","signature","secureCompare","module","exports"],"sources":["C:/Users/Heroism/Documents/Projects/Abcurrent/messageapp/node_modules/pusher/lib/token.js"],"sourcesContent":["const crypto = require(\"crypto\")\nconst util = require(\"./util\")\n\n/** Verifies and signs data against the key and secret.\n *\n * @constructor\n * @param {String} key app key\n * @param {String} secret app secret\n */\nclass Token {\n  constructor(key, secret) {\n    this.key = key\n    this.secret = secret\n  }\n  /** Signs the string using the secret.\n   *\n   * @param {String} string\n   * @returns {String}\n   */\n  sign(string) {\n    return crypto\n      .createHmac(\"sha256\", this.secret)\n      .update(Buffer.from(string))\n      .digest(\"hex\")\n  }\n  /** Checks if the string has correct signature.\n   *\n   * @param {String} string\n   * @param {String} signature\n   * @returns {Boolean}\n   */\n  verify(string, signature) {\n    return util.secureCompare(this.sign(string), signature)\n  }\n}\n\nmodule.exports = Token\n"],"mappings":"AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAMC,IAAI,GAAGD,OAAO,CAAC,QAAQ,CAAC;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA,MAAME,KAAK,CAAC;EACVC,WAAWA,CAACC,GAAG,EAAEC,MAAM,EAAE;IACvB,IAAI,CAACD,GAAG,GAAGA,GAAG;IACd,IAAI,CAACC,MAAM,GAAGA,MAAM;EACtB;EACA;AACF;AACA;AACA;AACA;EACEC,IAAIA,CAACC,MAAM,EAAE;IACX,OAAOR,MAAM,CACVS,UAAU,CAAC,QAAQ,EAAE,IAAI,CAACH,MAAM,CAAC,CACjCI,MAAM,CAACC,MAAM,CAACC,IAAI,CAACJ,MAAM,CAAC,CAAC,CAC3BK,MAAM,CAAC,KAAK,CAAC;EAClB;EACA;AACF;AACA;AACA;AACA;AACA;EACEC,MAAMA,CAACN,MAAM,EAAEO,SAAS,EAAE;IACxB,OAAOb,IAAI,CAACc,aAAa,CAAC,IAAI,CAACT,IAAI,CAACC,MAAM,CAAC,EAAEO,SAAS,CAAC;EACzD;AACF;AAEAE,MAAM,CAACC,OAAO,GAAGf,KAAK"},"metadata":{},"sourceType":"script","externalDependencies":[]}